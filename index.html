<html>
    <head>
        <title>Landsm&oslash;ede 2022</title>
    <style>
        body {
            margin: 0px; padding: 0px; height: 100%; width: 100%; text-align: center;
        }
        #f1 {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: -30px;
        }
    </style>

<body>
    <iframe id="f1" src="about:blank" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

    <script>
        var contentUrl = 'https://cdn.contentful.com/spaces/3bo0wgdn74or/environments/master/entries?access_token=78FV9bf1cCZA1kJamP2oGyqlazYISN_1wBEReGz0gtE&content_type=projectorScreen&select=fields.documentUrl,sys.updatedAt'
        var updatedAt = null;
        function update() {
            fetch(contentUrl)
            .then(function(response) { return response.json(); })
            .then(function (data) {
                if(!data ||!data.items || data.items.length === 0 || !data.items[0] || !data.items[0].fields || !data.items[0].fields.documentUrl) {
                    return;
                }

                var newUrl = data.items[0].fields.documentUrl;
                var documentUpdated = data.items[0].sys.updatedAt;
                var frame = document.getElementById('f1');
                if(frame.src === newUrl && updatedAt === updatedAt) {
                    return;
                }
                if(frame.src === newUrl) {
                    window.location.reload();
                }

                frame.src = newUrl;
                updatedAt = documentUpdated;
            });
        }

        var intervalMinutes = 1;
        update();
        setInterval(update, intervalMinutes * 60 * 1000);
    </script>
    </body>
</html>
